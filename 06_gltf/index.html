=<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="description" content="Hello, WebVR! • A-Frame">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-render-order-component@1.1.0/dist/aframe-render-order-component.min.js"></script>
    <script src="https://unpkg.com/aframe-orbit-controls@1.2.0/dist/aframe-orbit-controls.min.js"></script>
    <!--<script src="https://unpkg.com/aframe-supercraft-loader@1.1.3/dist/aframe-supercraft-loader.js"></script>-->
    <script>
    
    </script>

    <style>
      @import url('https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet');

      .play-overlay {
        z-index: 99999;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        box-sizing: border-box;
        width: 60%;
        height: 80%;
        background: rgba(255, 255, 255, 0.5) url(assets/btn.png) center no-repeat;
        background-size: 100% 100%;
      }
      .play-overlay:hover {
        background: rgba(255, 255, 255, 0.7) url(assets/btn.png) center no-repeat;
        background-size: 90% 90%;
        cursor: auto;
      }

      #figure {
        right: 0;
        float: left;
        color: white;
        margin: 10px 10px;
        background: transparent;
        font-family: 'Ubuntu', sans-serif;
        position: fixed;
        top: 100px;
        right: 100px;
        margin: 0 10px 10px 0;
        z-index: 1000;
      }

      #figure2 {
        right: 0;
        float: right;
        color: white;
        margin: 10px 10px;
        background: transparent;
        font-family: 'Ubuntu', sans-serif;
        position: fixed;
        top: 100px;
        right: 100px;
        margin: 0 10px 10px 0;
        z-index: 1000;
      }
      
    </style>

  </head>
  <body>
    
    <div id="figure">
      <p>Litto is alive</p>
    </div>
    <div id="figure2">
      <p>Litto is alive</p>
    </div>
    <a id="playButton" onclick="play('video_1')"><div class="btn btn-primary play-overlay menu-overlay"></div></a>

    <a-scene color-space="sRGB" background="color: #212122" renderer="sortObjects: true" shadow="autoUpdate: true" shadow="type: pcfsoft">

      <a-assets>
        <video id="video_1" src="assets/videos/02.webm"
        crossOrigin="anonymous"
        autoplay="false"
        loop="true"
        duration="16000"
        opacity="0.8"
        ></video>
        <img id="l00" src="assets/layers/layers11.png">
        <img id="l01" src="assets/layers/06__0003_01.png">
        <img id="l02" src="assets/layers/06__0002_02.png">
        <img id="l03" src="assets/layers/06__0001_03.png">
        <img id="l04" src="assets/layers/06__0000_04.png">
        <img id="l05" src="assets/layers/layers05.png">
        <img id="l06" src="assets/layers/layers06.png">
        <img id="l07" src="assets/layers/layers07.png">
        <img id="l08" src="assets/layers/layers08.png">
        <img id="l09" src="assets/layers/layers09.png">
        <img id="l10" src="assets/layers/layers10.png">
        <img id="l11" src="assets/sky_2.JPG">
        </a-assets>

        <!-- Red directional light shining from the top left. 
        <a-entity light="type:directional; castShadow:true; ; intensity: 0.5;" position="1 10 1"></a-entity>
        <a-entity light="type: ambient; intensity: 0.2;"></a-entity>
        <a-light type="point" color="white" position="0 6 0" castShadow="true" target="L1"></a-light> -->
      
        <a-entity light="type: ambient; intensity: 0.7;"></a-entity>
        <a-entity light="type: directional;
                   castShadow: true;
                   intensity: 0.4;
                   shadowCameraVisible: false;"
                  position="-1 3 0"></a-entity>

        <a-sphere
        id="L1"
        material="src: #l01; transparent: true; alphaTest: 0.5; sphericalEnvMap: #video_1; roughness: 0; metalness: 0.3;"
        shadow="receive: true"
        position="0 2.25 -5" 
        radius="1" 
        displacement-map="#l01"
        displacement-bias="0"
        animation__1op="property: opacity; dur: 8000; easing: linear; easing: easeInOutElastic; from:1; to: 1; dir: alternate; loop: true;"
        animation__1rot="property: rotation; dur: 8000; easing: linear; dir: normal; from:0 0 0; to: 0 -360 0; loop: true;"
        animation__1sc="property: scale; easing: easeInOutElastic; from: 2 2 2; to: 3 3 3; dir: alternate; loop: true;"
        animation__1dis="property: material.displacementScale; dir: alternate; loop: true;"
        animate-png
        ></a-sphere>
        
        <a-sphere
        id="L2"
        material="src: #l02; side: double; transparent: true; alphaTest: 0.5; sphericalEnvMap: #video_1; roughness: 0;"
        shadow="receive: false"
        segments-height="128"
        segments-width="128"
        position="0 2.25 -5" 
        radius="2" 
        animation__2op="property: opacity; dur: 8000; easing: linear; easing: easeInOutElastic; from:1; to: 1; dir: alternate; loop: true;"
        animation__2rot="property: rotation; dur: 8000; easing: linear; dir: normal; from:0 0 0; to: 0 0 0; loop: true;"
        animation__2sc="property: scale; easing: easeInOutElastic; from: 2 2 2; to: 3 3 3; dir: alternate; loop: true;"
        animation__2dis="property: material.displacementScale; dir: alternate; loop: true;"
        ></a-sphere>

        <a-sphere
        id="L3"
        material="src: #l03; side: double; transparent: true; alphaTest: 0.5; sphericalEnvMap: #video_1; roughness: 0.2;metalness: 0.5"
        shadow="receive: false"
        segments-height="200"
        segments-width="200"
        position="0 2.25 -5" 
        radius="3" 
        animation__3op="property: opacity; dur: 8000; easing: linear; easing: easeInOutElastic; from:1; to: 1; dir: alternate; loop: true;"
        animation__3rot="property: rotation; dur: 8000; easing: linear; dir: normal; from:0 0 0; to: 0 0 0; loop: true;"
        animation__3sc="property: scale; easing: easeInOutElastic; from: 2 2 2; to: 3 3 3; dir: alternate; loop: true;"
        animation__3dis="property: material.displacementScale; dir: alternate; loop: true;"
        ></a-sphere> 

        <a-entity camera look-controls orbit-controls="target: 0 1.6 -0.5; minDistance: 0.5; maxDistance: 20; initialPosition: 0 5 15"></a-entity>   
        <!-- <a-sky src="#video_1" radius="30" rotation="180 -50 180"></a-sky> -->

    </a-scene>
    <!-- webscrape corona -->
    <script src="js/scrape.js"></script>

    <script> 


      //VIDEO TEXTURE SKY
      videoTexture.format = THREE.RGBAFormat
    // wait until the material is ready
    this.el.addEventListener('materialtextureloaded', e => {
       // grab the material
       let material = this.el.getObject3D("mesh").material;
       // swap the format
       material.map.format = THREE.RGBAFormat;
       material.map.needsUpdate = true;
    })
    //Playbutton for video
      function play(id){
        var aVideoAsset = document.querySelector('#' + id);

        aVideoAsset.play().catch(function (error) {
          aVideoAsset.pause();
          hideOrShow("playButton");

        });
        aVideoAsset.setAttribute('loop', 'true');
        hideOrShow('playButton');
      }
      function hideOrShow(id) {
        var x = document.getElementById(id);
        if (x.style.display === "none") {
          x.style.display = "block";
        } else {
          x.style.display = "none";
        }
      }


      AFRAME.registerComponent("animate-png", {
        init: function() {
          // load the .pngs
          let loader = new THREE.TextureLoader()
          this.pngArray = []
          this.pngArray.push(loader.load('assets/04/frame_00000.png'))
          this.pngArray.push(loader.load('assets/04/frame_00002.png'))
          this.pngArray.push(loader.load('assets/04/frame_00003.png'))
          this.pngArray.push(loader.load('assets/04/frame_00004.png'))
          this.pngArray.push(loader.load('assets/04/frame_00005.png'))

          this.el.addEventListener('loaded', e => {
            let mesh = this.el.getObject3D("mesh")
            this.material = mesh.material

            var i = 0
            this.id = setInterval(e => {
              if (i >= this.pngArray.length) i = 0;
              this.material.map = this.pngArray[i++]
              this.material.needsUpdate = true
            }, 6000)
          })
        },

      })

      ///////// 

      const scene = document.querySelector('a-scene');
      
      const run = () => {

        //L1
        const sphere_1 = document.querySelector("#L1");
        const anim_1op = sphere.getAttribute("animation__1op");
        const anim_1sc = sphere.getAttribute("animation__1sc");
        const anim_1dis = sphere.getAttribute("animation__1dis");
        const anim_1rot = sphere.getAttribute("animation__1rot");
      
        //L2
        const sphere_2 = document.querySelector("#L2");
        const anim_2op = sphere.getAttribute("animation__2op");
        const anim_2sc = sphere.getAttribute("animation__2sc");
        const anim_2dis = sphere.getAttribute("animation__2dis");
        const anim_2rot = sphere.getAttribute("animation__2rot");

        //L3
        const sphere_3 = document.querySelector("#L3");
        const anim_3op = sphere.getAttribute("animation__3op");
        const anim_3sc = sphere.getAttribute("animation__3sc");
        const anim_3dis = sphere.getAttribute("animation__3dis");
        const anim_3rot = sphere.getAttribute("animation__3rot");

        // confirmed Z1 Z2 Z3 
        if (confRate > 0.01) {
          if (confRate <= 3) {
            // Z1
          document.getElementById('figure2')
          figure2.innerHTML = "is ok"
          } else if (confRate <= 5) {
            // Z2
          document.getElementById('figure2')
          figure2.innerHTML = "FUCK"
          } else {
            // Z3
            document.getElementById('figure2')
            figure2.innerHTML = "very FUCK"
          }
        } 
        // C = 0
        if(confRate === 0) {
          document.getElementById('figure2')
          figure2.innerHTML = "healthy"
        }
        // deaths Z! Z2 Z3
        if (deathRate > 2) {
          if (deathRate <= 5) {
            // Z1
          document.getElementById('figure4')
          figure2.innerHTML = "high//deaths"
          } else if (deathRate <= 10) {
            // Z2
          document.getElementById('figure4')
          figure2.innerHTML = "unstopable"
          } else {
            // Z3
            document.getElementById('figure4')
            figure2.innerHTML = "good bye"
          }
        }  

        if(deathRate > recRate) {
          document.getElementById('figure3')
          figure3.innerHTML = "Dˆ > Rˆ"
        } else {
          document.getElementById('figure3')
          figure3.innerHTML = "Dˆ < Rˆ"    
        }

          sphere.setAttribute("animation__1op", anim_1op);
          sphere.setAttribute("animation__1sc", anim_1sc);
          sphere.setAttribute("animation__1dis", anim_1dis);
          sphere.setAttribute("animation__1rot", anim_1rot);

          sphere.setAttribute("animation__2op", anim_2op);
          sphere.setAttribute("animation__2sc", anim_2sc);
          sphere.setAttribute("animation__2dis", anim_2dis);
          sphere.setAttribute("animation__2rot", anim_2rot);

          sphere.setAttribute("animation__3op", anim_3op);
          sphere.setAttribute("animation__3sc", anim_3sc);
          sphere.setAttribute("animation__3dis", anim_3dis);
          sphere.setAttribute("animation__3rot", anim_3rot);
          
          console.log("hello", confirmed);
      }

        if (scene.hasLoaded) {
          run()
        } else {
          scene.addEventListener('loaded', run)
        }

    </script>

  </body>
</html>